<html>
  <head>
    <title>Purple</title>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css' />
    <link href='css/main.css' rel='stylesheet' type='text/css' />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  </head>
  <body>
    <span id="config" data-base-url=""></span>


    <h2>Couriers</h2>

    <table id="couriers">
      <thead>
        <tr>
          <td>Connected</td>
          <td>Name</td>
          <td>Busy?</td>
          <td>Zones</td>
          <td>Location</td>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="connected"></td>
          <td class="name"></td>
          <td class="busy"></td>
          <td class="zones"></td>
          <td class="location">
            <a href="#" target="_blank"></a>
          </td>
        </tr>
      </tbody>
    </table>


    <h2>Orders</h2>
    
    <table id="orders">
      <thead>
        <tr>
          <td>Status</td>
          <td>Courier</td>
          <td>Order Placed</td>
          <td>Deadline</td>
          <td>Street</td>
          <td>Gallons</td>
          <td>Total Price</td>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="status"></td>
          <td class="courier_name"></td>
          <td class="target_time_start"></td>
          <td class="target_time_end"></td>
          <td class="address_street">
            <a href="#" target="_blank"></a>
          </td>
          <td class="gallons"></td>
          <td class="total_price"></td>
        </tr>
      </tbody>
    </table>

    <div style="margin-top: 75px;">
      <form id="configForm">
        <h3>Gas Price Per Gallon</h3>
        87 Octane (in cents) <input type="text" id="gasPriceDollars87" value="" />
        <br />
        91 Octane (in cents) <input type="text" id="gasPriceDollars91" value="" />
        
        <br /><br /><input type="submit" name="configFormSubmit" value="Save Changes" />
      </form>
      <div id="successMessage" style="display: none">
        Changed successfully.
      </div>
    </div>
    
    <script>
     $("#configForm").submit(function(e){
       e.preventDefault();
       var price87 = $("#gasPriceDollars87").val();
       var price91 = $("#gasPriceDollars91").val();
       var priceInCents87 = parseInt(price87.replace('$','').replace('.',''));
       var priceInCents91 = parseInt(price91.replace('$','').replace('.',''));
       $.ajax({
         type: "POST",
         url: $("#config").data("base-url") + "dashboard/change-gas-price",
         data: JSON.stringify(
           {
             "gas-price-87": priceInCents87,
             "gas-price-91": priceInCents91
           }
         ),
         dataType: "json",
         contentType: 'application/json',
         success: function(response) {
           if (response.success === true) {
             $("#configForm").fadeOut(400, function(){
               $("#successMessage").fadeIn(400);
             });
           }
         }
       });
     });
    </script>
  </body>
</html>
